#!/bin/bash

set -e

APP_NAME="purnet"
INSTALL_DIR="/opt/$APP_NAME"
SHORTCUT_NAME="PurNet.desktop"
USER_HOME="$HOME"
PYTHON_PATH=$(which python3)

echo "✅ نصب $APP_NAME در حال انجام است..."

# ساخت پوشه نصب
sudo mkdir -p "$INSTALL_DIR"
sudo cp main.py purwint icon.png "$INSTALL_DIR"
sudo chmod +x "$INSTALL_DIR/purwint"

# ساخت فایل دسکتاپ در دایرکتوری فعلی
echo "📄 در حال ساخت فایل شورتکات..."

cat > "./$SHORTCUT_NAME" <<EOF
[Desktop Entry]
Name=PurNet
Exec=$PYTHON_PATH $INSTALL_DIR/main.py
Icon=$INSTALL_DIR/icon.png
Type=Application
Terminal=false
Categories=Network;
EOF

chmod +x "./$SHORTCUT_NAME"

echo "✅ فایل $SHORTCUT_NAME ساخته شد."
echo "📌 می‌تونی این فایل رو بکشونی روی دسکتاپ یا توی منوی برنامه‌ها قرار بدی."
